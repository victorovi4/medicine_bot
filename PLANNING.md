# Медицинская карта — Планирование проекта

## Обзор

Персональная электронная медицинская карта для пациента Иоффе Виктора Борисовича (15.03.1947). Веб-приложение для хранения и отображения медицинских документов (анализы, УЗИ, консультации, выписки) в хронологическом порядке.

## Стек технологий

- **Frontend Framework:** Next.js 14 (App Router)
- **Language:** TypeScript
- **ORM:** Prisma
- **Database:** Vercel Postgres
- **File Storage:** Vercel Blob
- **Styling:** Tailwind CSS
- **UI Components:** shadcn/ui
- **Deployment:** Vercel

## Архитектура

```
medical-card/
├── prisma/
│   └── schema.prisma      # Схема базы данных
├── src/
│   ├── app/
│   │   ├── api/           # API роуты
│   │   │   ├── documents/ # CRUD документов
│   │   │   └── upload/    # Загрузка файлов
│   │   ├── add/           # Страница добавления
│   │   ├── documents/[id] # Страница просмотра
│   │   ├── page.tsx       # Главная (timeline)
│   │   ├── layout.tsx     # Root layout
│   │   └── globals.css    # Глобальные стили
│   ├── components/
│   │   ├── ui/            # shadcn компоненты
│   │   ├── PatientHeader.tsx
│   │   ├── DocumentCard.tsx
│   │   ├── Timeline.tsx
│   │   └── DocumentForm.tsx
│   └── lib/
│       ├── db.ts          # Prisma клиент
│       ├── types.ts       # Типы и константы
│       └── utils.ts       # Утилиты
├── tests/                 # Тесты (будут добавлены)
└── public/                # Статические файлы
```

## Модель данных

### Document
- `id` — UUID
- `date` — дата документа
- `type` — тип (анализ, узи, кт, мрт, консультация, выписка и т.д.)
- `title` — заголовок
- `doctor` — ФИО врача
- `specialty` — специальность врача
- `clinic` — медучреждение
- `summary` — краткое резюме (для AI в Этапе 2)
- `content` — полный текст
- `fileUrl` — URL файла в Vercel Blob
- `fileName` — имя файла
- `fileType` — MIME тип
- `tags` — теги
- `keyValues` — ключевые показатели (JSON)

## Этапы разработки

### Этап 1: MVP (текущий) ✅
- [x] Инициализация проекта
- [x] Схема базы данных
- [x] API для CRUD документов
- [x] Загрузка файлов
- [x] Timeline отображение
- [x] Форма добавления документа
- [x] Просмотр документа

### Этап 2: AI-анализ (планируется)
- [ ] Интеграция Claude API
- [ ] Автоматическое извлечение данных из текста/изображений
- [ ] Генерация summary и keyValues

### Этап 3: Telegram-бот (планируется)
- [ ] Webhook на Vercel
- [ ] Приём файлов в боте
- [ ] Автоматическое добавление в карту

### Этап 4: Улучшения (планируется)
- [ ] Авторизация
- [ ] Фильтры и поиск
- [ ] Графики показателей
- [ ] Экспорт в PDF

## Соглашения по коду

- Используем TypeScript
- Компоненты — функциональные
- Стили — Tailwind CSS классы
- Docstrings в Google стиле
- Русский язык для интерфейса
