# –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∫–∞—Ä—Ç–∞ ‚Äî –ò–æ—Ñ—Ñ–µ –í.–ë.

–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∫–∞—Ä—Ç–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìã **–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** ‚Äî –∞–Ω–∞–ª–∏–∑—ã, –£–ó–ò, –ö–¢, –ú–†–¢, –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏, –≤—ã–ø–∏—Å–∫–∏
- üìÖ **Timeline** ‚Äî —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –±–æ–ª–µ–∑–Ω–∏
- üìÅ **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤** ‚Äî PDF, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPG, PNG, WebP)
- ü§ñ **AI-–∞–Ω–∞–ª–∏–∑** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º
- ‚úèÔ∏è **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π
- üîç **–ü—Ä–æ—Å–º–æ—Ç—Ä** ‚Äî –ø—Ä–µ–≤—å—é –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- üè∑Ô∏è **–¢–µ–≥–∏** ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫
- üì± **Telegram-–±–æ—Ç** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä

## üõ† –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|------------|
| –§—Ä–µ–π–º–≤–æ—Ä–∫ | Next.js 16 (App Router) |
| –Ø–∑—ã–∫ | TypeScript |
| ORM | Prisma |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | Vercel Postgres |
| –•—Ä–∞–Ω–∏–ª–∏—â–µ | Vercel Blob |
| AI | OpenRouter (Claude Sonnet 4) |
| –°—Ç–∏–ª–∏ | Tailwind CSS |
| UI | shadcn/ui |
| –ë–æ—Ç | Telegram Bot API |
| –¢–µ—Å—Ç—ã | Vitest + Playwright |

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/victorovi4/medicine_bot.git
cd medicine_bot/medical-card

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env.local
# –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è (—Å–º. –Ω–∏–∂–µ)

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Prisma –∫–ª–∏–µ–Ω—Ç
npx prisma generate

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ö–µ–º—É –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
npx prisma db push

# –ó–∞–ø—É—Å—Ç–∏—Ç—å dev-—Å–µ—Ä–≤–µ—Ä
npm run dev
```

## ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local`:

```env
# Vercel Postgres
DATABASE_URL="postgres://..."

# Vercel Blob
BLOB_READ_WRITE_TOKEN="vercel_blob_..."

# OpenRouter API (–¥–ª—è AI-–∞–Ω–∞–ª–∏–∑–∞)
OPENROUTER_API_KEY="sk-or-..."

# –û—Ç–¥–µ–ª—å–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –±–∞–∑–∞ –¥–ª—è e2e (prod test-mode)
TEST_DATABASE_URL="postgres://..."

# Telegram Bot
TELEGRAM_BOT_TOKEN="7123456789:AAH..."

# URL –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–¥–ª—è —Å—Å—ã–ª–æ–∫ –≤ –±–æ—Ç–µ)
NEXT_PUBLIC_APP_URL="https://medicine-bot-4xqt.vercel.app"

# –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ Telegram ID (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
TELEGRAM_ALLOWED_USERS="123456789"
```

## üöÄ –î–µ–ø–ª–æ–π –Ω–∞ Vercel

1. –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ [vercel.com](https://vercel.com)
3. –£–∫–∞–∂–∏—Ç–µ **Root Directory**: `medical-card`
4. –î–æ–±–∞–≤—å—Ç–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:
   - Storage ‚Üí Create ‚Üí **Postgres** ‚Üí Connect to Project
   - Storage ‚Üí Create ‚Üí **Blob** ‚Üí Connect to Project
5. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   - `OPENROUTER_API_KEY`
   - `TELEGRAM_BOT_TOKEN`
   - `NEXT_PUBLIC_APP_URL`
   - `TELEGRAM_ALLOWED_USERS`
6. –î–µ–ø–ª–æ–π –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Webhook

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ POST-–∑–∞–ø—Ä–æ—Å:

```bash
curl -X POST https://–≤–∞—à-—Å–∞–π—Ç.vercel.app/api/telegram/setup
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ analyze/          # AI-–∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ documents/        # CRUD –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ telegram/         # Telegram webhook
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ upload/           # –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ add/                  # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ documents/[id]/       # –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ edit/             # –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx              # –ì–ª–∞–≤–Ω–∞—è (timeline)
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ ui/                   # shadcn –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ DocumentActions.tsx   # –ö–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ DocumentCard.tsx      # –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ DocumentForm.tsx      # –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ PatientHeader.tsx     # –®–∞–ø–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–∞—Ü–∏–µ–Ω—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ Timeline.tsx          # –õ–µ–Ω—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ claude.ts             # OpenRouter AI API
‚îÇ   ‚îú‚îÄ‚îÄ db.ts                 # Prisma –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ telegram.ts           # Telegram Bot API
‚îÇ   ‚îú‚îÄ‚îÄ types.ts              # –¢–∏–ø—ã –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ utils.ts              # –£—Ç–∏–ª–∏—Ç—ã
‚îî‚îÄ‚îÄ tests/                    # –¢–µ—Å—Ç—ã
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# Unit-—Ç–µ—Å—Ç—ã (Vitest)
npm run test

# Unit-—Ç–µ—Å—Ç—ã —Å watch
npm run test:watch

# E2E-—Ç–µ—Å—Ç—ã (Playwright)
npm run test:e2e

# –í—Å–µ —Ç–µ—Å—Ç—ã
npm run test:all
```

### Test-mode –Ω–∞ –ø—Ä–æ–¥–µ (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±–∞–∑–∞)

–î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ e2e –Ω–∞ –ø—Ä–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:

1. –°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—É—é –ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ Vercel Postgres)
2. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   - `TEST_DATABASE_URL` ‚Äî URL —Ç–µ—Å—Ç–æ–≤–æ–π –±–∞–∑—ã
3. –ó–∞–ø—É—Å–∫–∞–π—Ç–µ e2e —Å test‚Äëheader:

```bash
E2E_BASE_URL="https://medicine-bot-4xqt.vercel.app" \
E2E_TEST_MODE="true" \
npm run test:e2e
```

–ü—Ä–∏ `E2E_TEST_MODE=true` –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `x-test-mode: true`,
–∞ —Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `TEST_DATABASE_URL` –≤–º–µ—Å—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –±–∞–∑—ã.

## üì± Telegram-–±–æ—Ç

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ |
| `/status` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞—Ä—Ç—ã |
| `/last` | –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ |
| `/help` | –°–ø—Ä–∞–≤–∫–∞ |

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É —Ñ–æ—Ç–æ –∏–ª–∏ PDF –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
2. AI –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç
3. –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤—è—Ç—Å—è –≤ –º–µ–¥–∫–∞—Ä—Ç—É
4. –ë–æ—Ç –ø—Ä–∏—à–ª—ë—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# Dev-—Å–µ—Ä–≤–µ—Ä
npm run dev

# –°–±–æ—Ä–∫–∞
npm run build

# –õ–∏–Ω—Ç–∏–Ω–≥
npm run lint

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
npm run format

# Prisma Studio (GUI –¥–ª—è –ë–î)
npx prisma studio
```

## üìä API Endpoints

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|----------|
| GET | `/api/documents` | –°–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ |
| POST | `/api/documents` | –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç |
| GET | `/api/documents/[id]` | –ü–æ–ª—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç |
| PUT | `/api/documents/[id]` | –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç |
| DELETE | `/api/documents/[id]` | –£–¥–∞–ª–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç |
| POST | `/api/upload` | –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª |
| POST | `/api/analyze` | AI-–∞–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞ |
| POST | `/api/telegram/webhook` | Telegram webhook |
| POST | `/api/telegram/setup` | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å webhook |

## ‚úÖ Roadmap

- [x] **–≠—Ç–∞–ø 1:** MVP ‚Äî –±–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- [x] **–≠—Ç–∞–ø 2:** AI-–∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- [x] **–≠—Ç–∞–ø 3:** Telegram-–±–æ—Ç
- [ ] **–≠—Ç–∞–ø 4:** –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, —Ñ–∏–ª—å—Ç—Ä—ã, –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
